---
title: "고객사 PC 성능 분석 보고서 2"
date: 2025-12-31T14:30:00+09:00
categories: [고객사보고서]
tags: [보고서]
layout: single
author_profile: true
read_time: true
comments: true
share: true
related: true
---

고객사 PC 성능 심층 분석 (2025년 12월)

본 보고서는 고객사에 오렌지 더 클라이언트(Orange The Client)를 설치한 이후 12월 1일부터 12월 31일까지 수집된 데이터를 바탕으로 작성되었습니다. 분석 대상은 총 **17개 노드**이며, 현재 고객사 환경의 시스템 현황을 객관적으로 파악하고 향후 증상 발생 시 신속한 조치방안을 제공하는 것을 목표로 합니다.

오렌지 에이전트 분석 결과, 총 **11개 유형의 증상**이 확인되었으며, 이 중 업무 중단을 유발할 수 있는 5개 유형(블루스크린, 비정상종료, CPU 과점유, 강제종료, DNS)을 중점 분석하였습니다.

---

## 1. 자원 사용률 현황

전체 노드의 평균 자원 사용량은 양호한 수준입니다.

| 항목 | 평균값 |
| :--- | :--- |
| CPU 사용률 | 11.49% |
| 메모리 사용률 | 49.62% |
| 디스크 I/O | 52.18 MB/s |
| 핸들 수 | 111.67K |

다만, **고객 1 PC**는 총 메모리 7.7GB 중 7.1GB(92%)를 사용 중으로, 다른 직원들과 달리 백그라운드 프로그램이 다수 실행되어 메모리 사용률이 과도하게 높은 상태입니다.

### 1.1. 메모리 과다 사용 원인 프로그램

| 프로그램 | 설명 | 부하량 |
| :--- | :--- | :--- |
| WIZVERA Process Manager | 은행·공공기관 사이트 이용 시 자동 설치 | 23.2 |
| wpmsvc.exe | 인터넷 뱅킹/관공서 사이트 이용 시 설치 | 23 |
| nossvc.exe | 금융 사이트 이용 시 자동 설치 | 16 |
| pennyroyal.exe | 은행사이트 접속 시 자동 설치 | 8 |
| TEWebP.exe | 인터넷 뱅킹/관공서/보험사 사이트 이용 시 설치 | 7 |
| Goji.exe | 인터넷 뱅킹/관공서 사이트 이용 시 설치 | 6 |

*부하량은 프로세스의 동작 시간동안 CPU, Memory, I/O, Handle 사용량을 누적해서 산정한 Orange The Client만의 성능 수치입니다.

---

## 2. 증상 통계 및 주요 발생 유형

모니터링 기간 동안 발생한 증상 유형별 현황입니다.

| 증상 유형 | 발생 건수 | 설명 |
| :--- | :--- | :--- |
| DNS | 413 | DNS 이름 조회 실패 |
| TCP/IP | 127 | TCP/IP 통신 과정에서 연결 실패 |
| 비정상종료 | 29 | 오류로 인한 예기치 않은 종료 |
| CPU 과점유 | 18 | 특정 프로세스가 CPU를 과도하게 점유 |
| 강제종료 | 15 | 프로세스의 강제적인 종료 |
| 블루스크린 | 1 | 시스템 오류로 인해 PC가 강제 재부팅 |

---

## 3. 주요 증상별 원인 및 조치 방안

### 3.1. 블루스크린: IRQL_NOT_LESS_OR_EQUAL

| 구분 | 내용 |
| :--- | :--- |
| **증상** | 시스템 오류로 PC 강제 재부팅 (1건 발생) |
| **발생 사용자** | 고객 1 |
| **발생 프로세스** | System |
| **원인 모듈** | win32kbase.sys |
| **원인** | 그래픽(디스플레이) 드라이버 오류로 확인되었습니다. 화면 출력을 담당하는 드라이버가 시스템 종료 또는 장치 정리 과정에서 **비정상적인 메모리 접근**을 시도하면서 블루스크린이 발생했습니다. |
| **조치 방안** | 1) 해당 PC는 Intel UHD Graphics 630을 사용 중입니다. **Intel 공식 홈페이지** 또는 **Intel Driver & Support Assistant**를 통해 최신 그래픽 드라이버로 업데이트합니다. 2) 모니터링 기간 동안 1회 발생으로, 일시적인 오류일 가능성이 있어 재발 여부 모니터링이 필요합니다. |

**업데이트 링크**: https://www.intel.co.kr/content/www/kr/ko/download-center/home.html

---

### 3.2. DNS 문제: pennyroyal.exe의 비정상 DNS 쿼리

| 구분 | 내용 |
| :--- | :--- |
| **증상** | DNS 이름 조회 실패 (총 413건, 이 중 368건이 pennyroyal.exe 관련) |
| **발생 사용자** | 고객 1 |
| **원인** | Pennyroyal(악성 웹 사이트 탐지 서비스 APS Engine)이 사용자가 **문서 작업 중 입력한 문자열을 DNS 쿼리로 전송**하는 비정상적인 동작이 확인되었습니다. 쿼리명에 문서 내용으로 보이는 문자열(금액, 직원명 등)이 다수 포함되어 있습니다. |
| **조치 방안** | 1) 문서 작업 중 입력한 문자열로 DNS 쿼리를 수행하는 것은 비정상적인 동작입니다. **Pennyroyal.exe 삭제**를 권장합니다. (한국 금융권 및 공공기관 사이트 접속 시 설치되는 프로그램이나, 사용하지 않을 시 삭제) |

#### 기타 주요 DNS 실패 현황

| 발생 DNS | 원인 프로세스 | 사용자 수 | 발생 횟수 |
| :--- | :--- | :--- | :--- |
| pti.store.microsoft.com | svchost.exe | 10 | 46 |
| staging.to-do.officeppe.com | AppHostRegistrationVerifier.exe | 8 | 15 |
| directory.services.live.com | EXCEL.EXE | 2 | 69 |
| Gameplay.intel.com | igfxEM.exe | 2 | 72 |

---

### 3.3. TCP/IP 연결 문제

TCP/IP 증상은 총 127건이 발생했으며, 주요 유형은 다음과 같습니다.

#### 3.3.1. STATUS_IO_TIMEOUT (응답 시간 초과)

| 구분 | 내용 |
| :--- | :--- |
| **증상** | 서버에 연결을 시도했지만 응답이 오지 않아 시간 초과 |
| **프로세스 종류** | 14개 |
| **대상 IP/도메인** | 94개 |

**주요 발생 패턴:**

**1) svchost.exe → 내부 네트워크 대역 (포트: 7680)**
- 발생 사용자: 9명 (고객 2, 고객 3, 고객 4, 고객 1, 고객 5 등)
- 내부 대역 34개 IP로의 연결 시간 초과가 집중 발생
- **확인 필요**: 해당 IP들의 용도 및 현재 상태 확인

**2) 브라우저 4종 → 외부 대역 (포트: 443)**
- 발생 사용자: 고객 2
- msedge, msedgewebview2, chrome, whale에서 공통 연결 실패
- **확인 필요**: 업무에 지장이 있다면 방화벽 설정 확인

**3) spoolsv.exe → 프린터 연결 (포트: 9100)**
- 매 5분간 22회 연결 시도 실패가 지속 발생
- **확인 필요**: 대상 프린터의 네트워크 연결 상태 확인

| 사용자 | 대상 |
| :--- | :--- |
| 고객 5 | 프린터 A |
| 고객 1 | 프린터 A |
| 고객 6 | 프린터 B |

#### 3.3.2. STATUS_CONNECTION_REFUSED (서버 연결 거부)

| 구분 | 내용 |
| :--- | :--- |
| **증상** | 서버가 연결 요청을 명시적으로 거부 |
| **프로세스 종류** | 9개 |
| **대상 IP/도메인** | 10개 |
| **조치 방안** | 서버에서 해당 서비스가 실행 중인지 확인, 방화벽에서 해당 포트가 열려있는지 확인, 서비스 로그 확인 |

---

### 3.4. 비정상종료 상세

비정상종료는 총 29개 유형이 발생했습니다. 이 중 22개 유형은 하루~이틀간 발생한 일시적 현상이며, 7개 유형은 지속적으로 발생하여 상세 분석이 필요합니다.

#### 3.4.1. AdobeCollabSync.exe 비정상종료

| 구분 | 내용 |
| :--- | :--- |
| **증상** | Adobe Acrobat 업데이트 중 크래시 |
| **발생 사용자** | 고객 4, 고객 7 |
| **원인** | Adobe Acrobat 업데이트/설치 과정 중 AdobeCollabSync.exe가 실행되면서 **내부 버퍼 처리 오류**로 크래시 발생. 기존 25.1.20937 버전에서 최신 버전으로 업데이트 진행 시 발생. |
| **조치 결과** | 해당 사용자 2명 모두 최신 버전(25.001.20997)으로 업데이트 완료되었으며, **12월 12일 이후 동일 증상 미발생**. 다른 사용자의 동일 버전 업데이트 시 같은 증상 발생 가능성 있어 모니터링 필요. |

#### 3.4.2. arui.exe 비정상종료 (AhnLab EPP)

| 구분 | 내용 |
| :--- | :--- |
| **증상** | AhnLab EPP Privacy Management 관련 크래시 |
| **발생 사용자** | 고객 2 |
| **원인** | arui.exe가 `expire_postpone` 명령 실행 중 오류 발생. **라이선스 만료 UI 관련 오류**로 추정. |
| **조치 결과** | **2025년 1월 이후 미발생** 확인. 재발 시 EPP 관리자를 통해 라이선스 상태 및 만료 예정일 확인 필요. |

#### 3.4.3. dllhost.exe 비정상종료 (Fasoo DRM)

| 구분 | 내용 |
| :--- | :--- |
| **증상** | 탐색기 우클릭 메뉴/썸네일 기능 실행 시 크래시 |
| **발생 사용자** | 고객 4 |
| **원인** | Fasoo DRM의 쉘 확장 모듈(FasooShellMenu.dll)이 파일 우클릭 메뉴 표시 또는 DRM 문서 미리보기 생성 중 **잘못된 메모리 주소에 접근**하면서 발생. |
| **조치 방안** | 현재 설치된 프로그램은 "Fasoo DRM Client for Kyobo Book Wix"(교보문고 전자책 저작권 보호 프로그램)입니다. **사용하지 않으면 삭제**를 권장합니다. |

#### 3.4.4. Hwp.exe 비정상종료 (한글 → A3Dll32.dll)

| 구분 | 내용 |
| :--- | :--- |
| **증상** | 한글 프로그램 비정상 종료 |
| **발생 사용자** | 고객 2 |
| **원인** | 한글(Hwp.exe) 설치 시 함께 설치되는 보안 모듈 **A3Dll32.dll**에서 발생. 이 모듈은 실시간 악성코드 검사를 수행하며, 모듈 내부 장애로 인해 비정상 종료가 발생. |
| **조치 방안** | **실시간 악성 코드 검사 비활성화**: 한컴 기본 설정 실행 → 사용자 설정 → 보안 탭 선택 → 실시간 악성 코드 검사 항목 비활성화 |

---

### 3.5. CPU 과점유: ASDSvc.exe (AhnLab V3)

| 구분 | 내용 |
| :--- | :--- |
| **증상** | CPU 과점유 (총 18건, 이 중 AhnLab 관련 91건) |
| **발생 사용자** | 11명 (고객 1~11) |
| **발생 프로세스** | ASDSvc.exe (ASD Framework) |
| **원인 모듈** | msvcr90.dll, TSFltCtl.dll, MeDCore.dll |
| **원인** | AhnLab V3 제품의 ASDSvc.exe에서 CPU 과점유 발생. 평소 약 1.5% CPU 사용하지만, **업데이트 시 평균 22%까지 순간적으로 상승**. 실행 경로가 V3 업데이트 패치 경로로 확인되어, V3 제품 업데이트 과정에서 발생한 것으로 파악. |
| **조치 방안** | V3 업데이트 시 일시적으로 CPU 사용률이 상승하는 것은 **정상적인 동작**입니다. 다만, 업데이트가 장시간 지속되거나 반복적으로 발생할 경우 **AhnLab 고객센터에 문의**합니다. |

---

### 3.6. 강제종료

강제종료는 총 15개 유형이 발생하였습니다. **모든 증상이 단발성**으로, 각각 하루 정도만 발생한 것으로 확인됩니다. 지속적으로 반복되는 증상은 없어 현재 특별한 조치는 불필요한 것으로 판단됩니다.

---

## 4. 최종 결론 및 권고사항

### 4.1. 비정상종료 요약

| 발생 프로세스(사용자) | 원인 | 조치방안 |
| :--- | :--- | :--- |
| AdobeCollabSync.exe (고객 4, 고객 7) | Adobe 업데이트 중 버그 | 12월 12일 이후 미발생, 모니터링 유지 |
| arui.exe (고객 2) | AhnLab EPP 라이선스 만료 UI 오류 | 2025년 1월 이후 미발생, 재발 시 라이선스 확인 |
| dllhost.exe (고객 4) | Fasoo DRM 쉘 확장 모듈 오류 | Fasoo DRM 삭제 |
| Hwp.exe (고객 2) | A3Dll32.dll 오류 | 한컴 실시간 악성코드 검사 비활성화 |

### 4.2. 기타 증상 요약

| 증상 유형 | 원인 | 비고 |
| :--- | :--- | :--- |
| 블루스크린 (1건) | IRQL_NOT_LESS_OR_EQUAL | Intel 그래픽 드라이버 업데이트 |
| CPU 과점유 (18건) | V3 업데이트 시 일시적 CPU 상승 | 정상 동작, 장시간 지속 시 AhnLab 문의 |
| 강제종료 (15건) | 단발성 발생으로 확인 | 하루 정도만 발생 |
| DNS (413건) | 문서 작업 중 입력 문자열을 DNS 쿼리로 전송 | Pennyroyal.exe 삭제 |
| TCP/IP (127건) | 응답 요청 시간 초과, 서버 연결 거부 | 네트워크 및 서버 문제 |

### 4.3. 주요 권장 조치

| 주요 원인 | 권장 조치 |
| :--- | :--- |
| 그래픽 드라이버 오류 | Intel 최신 그래픽 드라이버 업데이트 |
| 보안 모듈 충돌 | 한글 프로그램 내 실시간 악성 코드 검사 기능 비활성화 |
| 불필요한 DNS 쿼리 | Pennyroyal.exe 삭제 |
| DRM 모듈 오류 | Fasoo DRM 삭제 (사용하지 않는 경우) |
| 메모리 과다 사용 | 불필요한 금융/공공기관 보안 프로그램 정리 |

**지속적인 모니터링과 정기적인 시스템 관리**를 통해 동일 증상의 재발을 방지하고 전반적인 시스템 안정성을 강화해야 합니다.
